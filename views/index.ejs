<section class="welcome-section">
 <h2>Welcome to The Inner Circle 
  <%= currentUser ? currentUser.first_name : "" %>
</h2>

  <% if (!currentUser) { %>
    <p class="intro-text">
      To unlock our <strong>exclusive community</strong>, please
      <a href="/sign-up" class="link">sign up</a> or
      <a href="/log-in" class="link">log in</a>.
    </p>
    <p class="why-join">
      Joining gives you access to member-only messages, secret discussions, and the chance to be part of something special.
    </p>
  <% } else { %>
    <p class="intro-text">
      Glad to have you inside, <strong><%= currentUser.first_name || currentUser.username %></strong> <% if (currentUser && currentUser.is_admin) { %>
  <p>üõ°Ô∏è You are an Admin!</p>
<% } %>!
    </p>
    <p class="member-message">
      Feel free to explore, create new messages, and connect with other member of the Inner Circle.
    </p>
     <% if (!currentUser.is_member) { %>
  <p>Become a <a href="/membership">member</a></p>
    <% } %>

      <% if (!currentUser.is_admin) { %>
   <p>Become an <a href="/admin">admin</a> </p>
    <% } %>
   
  <% } %>
</section>
 <section>
  <% if (currentUser && currentUser.is_member) { %>
    <p><a href="/new-message">Leave a message</a></p>
  <% } %>
</section>

<section class="messages">
  <h3>Messages</h3>
  <% messages.forEach(message => { %>
    <div class="message-card">
      <h4><%= message.title %></h4>
      <p><%= message.content %></p>
      <small>
        By <%= message.username %>
        <% 
          const user = users.find(u => u.id === message.user_id);
          if (currentUser && user && user.is_member) { 
        %>
          <span class="badge member">(Member)</span>
        <% } %>
        <% if (currentUser && user && user.is_admin) { %>
          <span class="badge admin">(Admin)</span>
        <% } %>
      </small>
      <br>

      <% if (currentUser && currentUser.id === message.user_id) { %>
        <a href="/message/<%= message.id %>/edit">Edit</a>
      <% } %>

      <% if (currentUser && (currentUser.id === message.user_id || currentUser.is_admin)) { %>
        <form action="/message/<%= message.id %>/delete" method="POST" style="display:inline;">
          <button type="submit" onclick="return confirm('Are you sure you want to delete this message?')">Delete</button>
        </form>
      <% } %>

      <small>At <%= new Date(message.created_at).toLocaleString() %></small>
    </div>
  <% }) %>
</section>



